# 数据库配置说明

## 当前配置状态

### 默认配置（无profile）
- **数据库**：MySQL
- **连接**：`jdbc:mysql://localhost:3306/agriverse`
- **用户名**：`root`
- **密码**：`root`
- **DDL模式**：`update`（自动创建/更新表）

### 开发环境（dev profile）
- **数据库**：MySQL（已从H2切换）
- **连接**：`jdbc:mysql://localhost:3306/agriverse`
- **用户名**：`root`
- **密码**：`root`
- **DDL模式**：`update`（自动创建/更新表）
- **SQL日志**：开启（`show-sql: true`）

### 测试环境（test profile）
- **数据库**：H2内存数据库（保持不变，测试用）
- **连接**：`jdbc:h2:mem:testdb`
- **DDL模式**：`create-drop`（每次测试重新创建）

### 生产环境（prod profile）
- **数据库**：MySQL
- **DDL模式**：`validate`（仅验证，不修改表结构）

## 快速启动

### 使用MySQL数据库启动

**Windows:**
```cmd
cd backend
start-mysql.bat
```

**Linux/Mac:**
```bash
cd backend
chmod +x start-mysql.sh
./start-mysql.sh
```

**或使用Maven命令:**
```bash
cd backend
mvn spring-boot:run -Dspring.profiles.active=dev
```

## 修改数据库连接

编辑 `backend/src/main/resources/application.yml`：

```yaml
spring:
  datasource:
    url: jdbc:mysql://your-host:3306/agriverse?useUnicode=true&characterEncoding=utf8mb4&serverTimezone=Asia/Shanghai
    username: your_username
    password: your_password
```

## 数据库初始化

### 自动初始化（推荐）
应用启动时，如果表不存在，Hibernate会自动创建。

### 手动初始化
执行 `backend/init.sql` 脚本：

```bash
mysql -uroot -proot agriverse < backend/init.sql
```

## 注意事项

1. **确保MySQL服务已启动**
2. **确保数据库已创建**：`CREATE DATABASE agriverse;`
3. **检查端口**：默认3306
4. **检查用户权限**：确保用户有创建表的权限

详细说明请查看：`backend/MySQL部署说明.md`

